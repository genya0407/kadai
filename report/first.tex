\documentclass[11pt]{ltjsarticle}

\usepackage{fontspec}
%\setmainfont[BoldFont=Times Bold, ItalicFont=Times Italic, BoldItalicFont=Times Bold Italic]{Times}
%\setsansfont[BoldFont=Helvetica Neue Bold, ItalicFont=Helvetica Neue Italic, BoldItalicFont=Helvetica Neue Bold Italic]{Helvetica Neue}
%\setmonofont{Menlo}
\usepackage{luatexja-fontspec}
\usepackage[hiragino-pron]{luatexja-preset}
\usepackage{luatexja-ruby}
\usepackage{graphicx}



%\renewcommand{\headfont}{\bfseries\sffamily

\title{電気電子計算工学及演習}
\author{三軒家 佑將（さんげんや ゆうすけ） \\ ３回生 \\ 1026-26-5817 \\ a0146089}
\date{}

\begin{document}
\maketitle


以下のレポートにおいては、プログラミング言語としてGo言語(https://goo.gl/pclkeC)を用いた。

また、ソースコードは巻末にまとめて添付した。

\section{採用したアルゴリズム}
\subsection{行列とベクトルの演算を行う関数の実装}
	行列ベクトル積の演算を行う関数MatVecと、行列積の演算を行う関数MatMltを、ソースコード1のとおりに実装した。
	\subsubsection*{MatVec}
		行列ベクトル積の演算は、「引数の行列の各行ベクトル」と、引数のベクトルの内積を並べたものと考えることができる。
		この考えに則り、ベクトルの内積を計算する補助関数dotを定義し、それを用いて行列ベクトルの計算を行った。
	\subsubsection*{MatMlt}
		行列積の演算は、引数1の行列と「引数2の行列の各列ベクトル」の行列ベクトル積を並べたものと考えることができる。
		この考えに則り、MatVec関数を用いて行列積の計算を行った。

\subsection{バッタGの移動}
	ある時刻tの存在確率ベクトル（地点0,1,2,3,4,5にいる確率を並べたもの）${\bf p}_t$は、
	\[
		{\bf p}_t = {\bf A}{\bf p}_{t-1}
	\]
	によって求めることができる。ただし{\bf A}は、表1の数値部分を行列と考え、さらにそれの転置を取ったものである。
	
	この考え方に則って、バッタGが、ある時刻$0 \leq t \leq 60$に地点0,1,2,3,4,5にいる確率を計算した(ソースコード2)。

    \begin{table}[]
        \centering
        \begin{tabular}{|l|l|l|l|l|l|l|}
        \hline
        	& \multicolumn{6}{l|}{一秒後にこの地点に移動する確率}                                    \\ \hline
        	現在地 & 地点0          & 地点1        & 地点2    & 地点3    & 地点4        & 地点5          \\ \hline
        	地点0 & s+(1-s)(1-c) & (1-s)c     & 0      & 0      & 0          & 0            \\ \hline
        	地点1 & (1-s)(1-c)   & s          & (1-s)c & 0      & 0          & 0            \\ \hline
        	地点2 & 0            & (1-s)(1-c) & s      & (1-s)c & 0          & 0            \\ \hline
        	地点3 & 0            & 0          & (1-s)c & s      & (1-s)(1-c) & 0            \\ \hline
        	地点4 & 0            & 0          & 0      & (1-s)c & s          & (1-s)(1-c)   \\ \hline
        	地点5 & 0            & 0          & 0      & 0      & (1-s)c     & s+(1-s)(1-c) \\ \hline
        \end{tabular}
        \caption{バッタGの振る舞い}
    \end{table}

\subsection{パラメータcによるバッタGの振る舞いの変化}
	ソースコード3のプログラムを用いて、s=0.15とし、c=0.7,0.5,0.45の３つの場合について、前節と同様の考え方に則り、時刻$0 \leq t \leq 60$において各地点にGがいる確率を計算した。

\subsection{ニュートン法による非線形方程式の解}

	以下の２つの非線形方程式について、ソースコード4のプログラムを用いて、ニュートン法によって定められた範囲の解を求めた。

	\begin{eqnarray}
       - 2.2 x^4 + 3.5x^3 + 4.1x^2 + 3.3x - 2.7 & = & 0, (0 \leq x \leq 1) \\
       - {\rm cos}(2x+2) + {\rm exp}(x+1) - 2x -30 & = & 0, (0 \leq x \leq \pi)
	\end{eqnarray}
	
	大部分は授業で示されたアルゴリズムを実装しただけである。ただし、終了条件については以下のようにした。
	
	\begin{itemize}
		\item 修正量が$\epsilon$より小さくなり、かつ、${\rm f(x)}$が$\epsilon$より小さくなったとき終了
		\item 上の条件が満たされないまま、$k=10$まで近似解を求めたとき終了
	\end{itemize}
	
	また、$\epsilon$としては、Go言語のfloat64型の中で、最も絶対値が小さい値である math.SmallestNonzeroFloat64 を用いた。
	これにより、修正量と${\rm f(x)}$の値がどちらも$0$とならない限りは、後者の条件によって終了することになる。
	
	前者のような終了条件を設定したのは、片方の条件のみでは収束しているように見えても、もう片方の条件を見ると収束していないような場合があると考えられるからである。
	また、後者のような終了条件を設定したのは、実際にはどちらの方程式も$k=10$程度までで${\rm x}$の値が収束したからである。

\section{課題を解くために作成したプログラムに関する情報}
	プログラムのファイル名については、各ソースコード中に記載した。
	
	また、どのプログラムに関しても、 "go run {\it filename}" コマンドにて実行できる。

	定義した関数の機能や呼び出し方法は、ソースコード中にコメントで注釈があるので、それを参照のこと。
	
	使用上の注意としては、ソースコード1,2の冒頭は、"package matmlt"などとなっているが、これを単体として実行するときには、この部分を"package main"に書き換える必要がある。
	
	また、上記の注意とは別に、ソースコード2,3,4は、他のソースコードをモジュールとして読み込んで動作するので、単体で動作させることはできない。
	また、ソースコード2,3を実行するためには、CSVファイルを書き出すディレクトリとして、実行時のディレクトリ以下に'res'という名前のディレクトリが存在していないといけない。
	これらの理由から、正しく動作させるためには、以下のようなディレクトリ構成とファイルの配置にする必要がある。
	
\begin{verbatim}
.
├── 1_3.go
├── 1_4.go
├── locust
│      └── locust.go
├── matmul
│      └── matmul.go
└── res
\end{verbatim}

\section{結果}
\subsection{行列とベクトルの演算を行う関数の実装}
	ソースコード1に含まれる動作確認により、MatVec関数とMatMlt関数が正常に動作していそうなことを確認した。

\subsection{バッタGの移動}
	ある時刻tにおいて、地点1, 4にバッタGがいる確率をグラフに描画したのが、図1,2,3である。

	\begin{figure}
  		\includegraphics[width=\textwidth]{fig1.png}
  		\caption{時刻 t における地点1,4でのバッタGの存在確率(s=0.05)}
	\end{figure}

	\begin{figure}
  		\includegraphics[width=\textwidth]{fig2.png}
  		\caption{時刻 t における地点1,4でのバッタGの存在確率(s=0.15)}
	\end{figure}

	\begin{figure}
  		\includegraphics[width=\textwidth]{fig3.png}
  		\caption{時刻 t における地点1,4でのバッタGの存在確率(s=0.5)}
	\end{figure}

\subsection{パラメータcによるバッタGの振る舞いの変化}
	$t=60$において各地点にGがいる確率をグラフにしたのが、図4,5,6である。

\begin{figure}
  \includegraphics[width=\textwidth]{fig4.png}
  \caption{ t=60における各地点でのGの存在確率(c=0.7)}
\end{figure}

\begin{figure}
  \includegraphics[width=\textwidth]{fig5.png}
  \caption{ t=60における各地点でのGの存在確率(c=0.5)}
\end{figure}

\begin{figure}
  \includegraphics[width=\textwidth]{fig6.png}
  \caption{ t=60における各地点でのGの存在確率(c=0.45)}
\end{figure}

\subsection{ニュートン法による非線形方程式の解}

計算結果として、(1)に対しては$x = 0.4685126936655117$、(2)に対しては$x = 2.6107790395825665$という解が得られた。


\section{考察}

\subsection{行列とベクトルの演算を行う関数の実装}
\subsection{バッタGの移動}
\subsection{パラメータcによるバッタGの振る舞いの変化}
\subsection{ニュートン法による非線形方程式の解}

\end{document}