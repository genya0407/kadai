\documentclass[11pt]{jsarticle}

\usepackage[dvipdfmx]{graphicx}
\usepackage{comment}
\usepackage{listings, jlisting}
\usepackage{amsmath, amssymb}

\title{電気電子計算工学及演習 課題4}
\author{三軒家 佑將（さんげんや ゆうすけ） \\ ３回生 \\ 1026-26-5817 \\ a0146089}
\date{}

\newcommand{\fg}[3]{ % \fg{label}{path}{caption},
    \begin{figure}
        \centering
        \includegraphics[width=0.9\textwidth]{#2}
        \caption{#3}
        \label{#1}
    \end{figure}
}

\newcommand{\tab}[3]{ % \tab{label}{csv-path}{caption}
    \begin{table}[htb]
          \begin{center}
            %\input{#2}
            \csvautotabular{#2}
            \caption{#3}
            \label{#1}
          \end{center}
    \end{table}
}

\newcommand{\code}[1]{
    \lstinputlisting{ ../src/#1 }
}

\newcommand{\fr}[1]{図\ref{#1}}
\newcommand{\tr}[1]{表\ref{#1}}
\newcommand{\er}[1]{式(\ref{#1})}

\newcommand{\kb}{{\bf k}}
\newcommand{\xb}{{\bf x}}
\newcommand{\fb}{{\bf f}}
\newcommand{\dtn}{{\rm dt}}

\begin{document}
\maketitle

\section{プログラムの説明}
\subsection{概要}
本レポートにおいては、プログラム言語としてHaskellを採用した。
行列演算ライブラリとしては、hmatrix(https://hackage.haskell.org/package/hmatrix)を用いた。

また、グラフを描画する際には、Jupyter notebookおよびIRuby kernelを用いた。

プログラムを実行する手順は、以下のとおりである。
\begin{lstlisting}[language=bash]
> cd haskell
> stack build
> stack exec one-power # 課題4.1.1
> stack exec one-jacobi # 課題4.1.2
> stack exec two # 課題4.2
> stack exec three-trapezoidal # 課題4.3
> stack exec three-simpsons # 課題4.3
\end{lstlisting}

\subsection{各機能・関数の説明}
プログラムを作成するにあたって、見通しを良くするために、プログラムを複数のファイルに分割している。
ここでは、各ファイルごとに、そのファイルの担う機能と、そのファイル内にある関数の機能などについて簡単に説明する。

各関数の詳しい使用方法などは、プログラム内のコメントにて示したので、そちらを参照されたい。

\subsubsection*{app/OnePower.hs}
課題4.1.1を解くプログラム。
固有ベクトルと、収束判定に用いたスカラ値の値を出力する。

\subsubsection*{app/OneJacobi.hs}
課題4.1.2を解くプログラム。
${\rm U} {\rm U}^{\rm T}$と${\rm U}\Lambda{\rm U}^{\rm T}$を出力する。

\subsubsection*{app/Two.hs}
課題4.2.1、課題4.2.2を解くプログラム。
\begin{itemize}
    \item k
    \item 複合台形公式による積分結果
    \item 複合シンプソン公式による積分結果
\end{itemize}
をCSVにして標準出力に出力する。

\subsubsection*{app/ThreeTrapezoidal.hs}
課題4.3を解くプログラム。各定義式から$\pi$を求めるが、そのとき複合台形公式を用いる。

以下の内容がCSV形式で標準出力に出力される。
\begin{itemize}
    \item k
    \item 問の定義式１による$\pi$の計算結果
    \item 問の定義式２による$\pi$の計算結果
    \item 問の定義式３による$\pi$の計算結果
    \item 問の定義式４による$\pi$の計算結果
\end{itemize}

\subsubsection*{app/ThreeSimpsons.hs}
課題4.3を解くプログラム。
app/Threetrapezoidal.hsと同様のことを行なうが、その際、複合台形公式ではなく、複合シンプソン公式を用いる。

\subsubsection*{src/Types.hs}
本プログラムにて使用する型シノニムを定義したファイル。

\subsubsection*{src/Integrator/Default.hs}
複合台形公式によって積分計算を行なう関数(compositTrapezoidalRule)と、
複合シンプソン公式によって積分計算を行なう関数(compositSimpsonsRule)を定義したファイル。

\subsubsection*{src/Three.hs}
calc関数をexportしており、課題4.3を解くのに使われる。

\subsubsection*{src/Integrator/Recursive.hs}
src/Integrator/Default.hsと同様の関数をexportしているが、その際のアルゴリズムが、Default.hsのそれとは異なる。
詳細は考察にて述べる。

\subsubsection*{app/TwoExtra.hs}
考察に用いるプログラム。
詳細は考察にて述べる。


\section{課題4.1.1}
べき乗法によって、固有ベクトル$u_1$を計算した。
このとき、収束条件は、テキスト6.3節に記載されたものを使用し、また、$\epsilon = 10 ^ {-15}$とした。
\subsection{結果}
\fg{fig1}{graph/4_1_1.png}{収束判定に用いたスカラ値}

収束判定に用いたスカラ値($\left| \gamma_{max} - \gamma_{min} \right|$)と、
行列Aを初期値${rm u_0}$に乗じた回数の関係を片対数グラフに描いたのが\fr{fig1}である。

Aを乗じるごとに、指数的に$u_1$へと収束していることがわかる。

\section{課題4.1.2}
ヤコビ法によって、固有値行列$\Lambda$と、固有ベクトル行列${\rm U}$を求めた。

\subsection{結果}

${\rm U} {\rm U}^{\rm T}$と${\rm U}\Lambda{\rm U}^{\rm T}$を出力した結果、以下のようになった。

\[
    {\rm U} {\rm U}^{\rm T} =
    \left(\begin{array}{cccccc}
        1.00e+00&-2.43e-16&8.33e-17&2.50e-16&8.33e-17&-4.30e-16\\
        -2.43e-16&1.00e+00&2.91e-16&3.33e-16&-1.39e-16&-2.22e-16\\
        8.33e-17&2.91e-16&1.00e+00&-1.94e-16&-5.55e-17&-1.39e-16\\
        2.50e-16&3.33e-16&-1.94e-16&1.00e+00&-1.94e-16&-2.78e-17\\
        8.33e-17&-1.39e-16&-5.55e-17&-1.94e-16&1.00e+00&-5.55e-17\\
        -4.30e-16&-2.22e-16&-1.39e-16&-2.78e-17&-5.55e-17&1.00e+00\\
    \end{array}\right)
\]

\[
    {\rm U}\Lambda{\rm U}^{\rm T} = 
    \left(\begin{array}{cccccc}
        2.00&3.00&4.00&5.00&6.00&7.00\\
        3.00&8.00&9.00&10.00&11.00&12.00\\
        4.00&9.00&13.00&14.00&15.00&16.00\\
        5.00&10.00&14.00&17.00&18.00&19.00\\
        6.00&11.00&15.00&18.00&20.00&21.00\\
        7.00&12.00&16.00&19.00&21.00&22.00\\
    \end{array}\right)
\]

${\rm U} {\rm U}^{\rm T}$は単位行列とほとんど等しい値に、
${\rm U}\Lambda{\rm U}^{\rm T}$はAとほとんど等しい値となっていることがわかる、

\section{課題4.2}
積分$ \int^{1}_{0} x^{19} dx $を、分割数$n = 2 ^ k$の複合台形公式と複合シンプソン公式を用いて求め、
真の値との相対誤差の対数を求めた。

\subsection{結果}
\fg{fig2}{graph/4_2.png}{kと相対誤差の対数の関係}
kと相対誤差の対数の関係をグラフに描いたのが\fr{fig2}である。

複合台形公式でも複合シンプソン公式でも、kに対して指数的に相対誤差が減少している事がわかる。
また、減少のスピードは、複合シンプソン公式の方が速いことがわかる。

\section{課題4.3}
以下に示された定義式(1)〜(4)を用いて、$\pi$を求めた。
このとき、積分計算の手法として、分割数$n = 2^k$の複合台形公式と複合シンプソン公式をそれぞれ用いた。

\begin{eqnarray}
    \frac{\pi}{4} & = & \int^{1}_{0}\frac{1}{1+x^2}dx \\
    \frac{\pi}{4} & = & \int^{1}_{0}\sqrt{1 - x^2}dx \\
    \frac{\pi}{12}+\frac{\sqrt 3}{8} & = & \int^{1/2}_{0} \sqrt{1 - x^2} dx \\
    \frac{\pi}{6}-\frac{\sqrt 3}{8} & = & \int^{1}_{1/2} \sqrt{1 - x^2} dx
\end{eqnarray}

\subsection{結果}
\fg{fig3}{graph/4_3_trapezoidal.png}{複合台形公式による計算}
\fg{fig4}{graph/4_3_simpsons.png}{複合シンプソン公式による計算}

\fr{fig3}と\fr{fig4}はそれぞれ、複合台形公式と複合シンプソン公式によって、定義式(1)〜(4)から$\pi$を求めた際の、真の値からの誤差の対数とkの関係をグラフに描いたものである。

いずれの場合も、定義式(1)と(3)を用いた場合の方が、それ以外の式を用いた場合に対して精度が高い。
また、複合台形公式を用いたときは、定義式(1)(3)と定義式(2)(4)のそれぞれが、
ほとんど同じ精度で計算できているのに対し、
複合シンプソン公式を用いたときは、定義式(2)と(4)のkに対する計算精度は異なることがわかる。

\section{考察}
% 考察（計算方法に関する考察、得られた結果の精度、うまく行かなかったと思われる点、その他、気付いた点や考えたことについて）

\subsection{再帰的実装}

\section{付録}
\subsection{ソースコード}
ソースコードは別に添付する。

\subsection{出力結果}
出力結果は、別に添付したファイルoutput.txtに示す。

\section{参考文献}
\begin{enumerate}
\item
\end{enumerate}
\end{document}
